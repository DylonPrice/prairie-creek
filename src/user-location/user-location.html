<html><head><link rel="import" href="../../bower_components/polymer/polymer.html"></head><body><dom-module id="user-location"><script>Polymer({is:'user-location',properties:{latitude:{type:Number,notify:!0,readOnly:!0},longitude:{type:Number,notify:!0,readOnly:!0},active:{type:Boolean,value:!1},error:{type:String,notify:!0},_watchId:{type:Number},highAccuracy:{type:Boolean,value:!1,observer:'_updateWatchLocation'},watch:{type:Boolean,value:!0,observer:'_updateWatchLocation'}},ready:function(){'geolocation'in navigator?this._updateWatchLocation():(alert('Geolocation not available on this device.'),console.log('Geolocation not available'))},_updateWatchLocation:function(){var a={enableHighAccuracy:this.highAccuracy};this._clearAnyExistingWatches(),this.watch&&(navigator.geolocation.getCurrentPosition(this._updatePosition(),this._onError(),a),this._watchId=navigator.geolocation.watchPosition(this._onPositionChanged(),this._onError(),a))},_clearAnyExistingWatches:function(){this._watchId&&(navigator.geolocation.clearWatch(this._watchId),this._watchId=null)},_onError:function(){var b=this;return function(c){switch(c.code){case c.PERMISSION_DENIED:b.error='Permission denied';break;case c.POSITION_UNAVAILABLE:b.error='Position unavailable';break;case c.TIMEOUT:b.error='Timeout';break;case c.UNKNOWN_ERROR:b.error='Unknown error';}console.log('Geolocation error('+c.code+'): '+b.error)}},_onPositionChanged:function(){var a=this;return function(b){a.active?a._updatePosition()(b):console.log('Ignoring location change; inactive')}},_updatePosition:function(){var a=this;return function(b){var c=b.coords;a._setLatitude(c.latitude),a._setLongitude(c.longitude),console.log('Latitude is ',a.latitude,' and longitude is ',a.longitude),a.error=''}}});</script></dom-module></body></html>